<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="RocketWhisperの使い方ガイド。インストール方法から高度な設定まで詳しく解説。">
    <title>使い方ガイド - RocketWhisper</title>
    <link rel="icon" type="image/png" href="images/RocketWhisper3.png">
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap" rel="stylesheet">
</head>
<body>
    <!-- ナビゲーション -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <img src="images/RocketWhisper3.png" alt="RocketWhisper" class="nav-icon">
                <span>RocketWhisper</span>
            </a>
            <button class="nav-toggle" aria-label="メニュー">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-menu">
                <li><a href="index.html#features">機能</a></li>
                <li><a href="index.html#how-it-works">使い方</a></li>
                <li><a href="index.html#download">ダウンロード</a></li>
                <li><a href="purchase.html">購入</a></li>
                <li><a href="help.html" class="active">ヘルプ</a></li>
                <li><a href="privacy.html">プライバシー</a></li>
                <li><a href="support.html">サポート</a></li>
            </ul>
        </div>
    </nav>

    <!-- ページヘッダー -->
    <header class="page-header">
        <div class="container">
            <h1>使い方ガイド</h1>
            <p>RocketWhisperの基本的な使い方から高度な設定まで、詳しく解説します。</p>
        </div>
    </header>

    <!-- メインコンテンツ -->
    <main class="page-content">
        <div class="container">
            <!-- 目次 -->
            <nav class="content-section">
                <h2>目次</h2>
                <ol>
                    <li><a href="#installation">インストール方法</a></li>
                    <li><a href="#basic-usage">基本的な使い方</a></li>
                    <li><a href="#settings">設定</a></li>
                    <li><a href="#hotkey">グローバルホットキー</a></li>
                    <li><a href="#batch">バッチ処理</a></li>
                    <li><a href="#history">認識履歴</a></li>
                    <li><a href="#text-processing">テキスト処理（句読点・改行）</a></li>
                    <li><a href="#voice-commands">音声コマンド</a></li>
                    <li><a href="#custom-terms">専門用語登録</a></li>
                    <li><a href="#correction-rules">誤認識修正ルール</a></li>
                    <li><a href="#app-specific">アプリ別処理モード</a></li>
                    <li><a href="#ai-formatting">AI処理（LLM連携）</a></li>
                    <li><a href="#ai-command">AIコマンドモード</a></li>
                    <li><a href="#recording-indicator">録音中インジケーター</a></li>
                    <li><a href="#voice-launcher">音声ランチャー</a></li>
                    <li><a href="#voice-search">音声検索</a></li>
                    <li><a href="#tray-icon">トレイアイコン</a></li>
                    <li><a href="#troubleshooting">トラブルシューティング</a></li>
                </ol>
            </nav>

            <!-- インストール -->
            <section class="content-section" id="installation">
                <h2>1. インストール方法</h2>

                <h3>動作要件</h3>
                <ul>
                    <li>Windows 11 (64bit)</li>
                    <li>.NET 8.0 Desktop Runtime</li>
                    <li>RAM 8GB以上推奨</li>
                    <li>GPU（CUDA対応）があると高速化</li>
                </ul>

                <h3>インストール手順</h3>
                <ol>
                    <li><a href="index.html#download">ダウンロードページ</a>から最新版をダウンロード</li>
                    <li>ダウンロードしたZIPファイルを展開</li>
                    <li><code>RocketWhisper.exe</code> を実行</li>
                    <li>初回起動時、使用するWhisperモデルをダウンロード</li>
                </ol>

                <div class="info-card">
                    <h4>モデルの選び方</h4>
                    <table class="command-table">
                        <thead>
                            <tr>
                                <th>モデル</th>
                                <th>サイズ</th>
                                <th>精度</th>
                                <th>速度</th>
                                <th>おすすめ用途</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>small</td>
                                <td>466MB</td>
                                <td>高</td>
                                <td>速い</td>
                                <td>低スペックPC向け</td>
                            </tr>
                            <tr>
                                <td>medium</td>
                                <td>1.5GB</td>
                                <td>高</td>
                                <td>普通</td>
                                <td><strong>5秒以内の音声におすすめ</strong></td>
                            </tr>
                            <tr>
                                <td>large-v3-turbo</td>
                                <td>1.6GB</td>
                                <td>高</td>
                                <td>速い</td>
                                <td><strong>5〜20秒の音声におすすめ</strong></td>
                            </tr>
                            <tr>
                                <td>large-v3</td>
                                <td>2.9GB</td>
                                <td>最高</td>
                                <td>やや遅い</td>
                                <td><strong>20秒以上の音声におすすめ</strong></td>
                            </tr>
                        </tbody>
                    </table>
                    <p><strong>💡 選び方のポイント</strong></p>
                    <ul>
                        <li><strong>短い音声（5秒以内）</strong>：medium がおすすめ</li>
                        <li><strong>中程度の音声（5〜20秒）</strong>：large-v3-turbo がおすすめ</li>
                        <li><strong>長い音声（20秒以上）</strong>：large-v3 が高精度</li>
                    </ul>
                    <p class="note">※ 大きなモデルは短い音声で繰り返しが発生することがあります。短い発話が中心の場合は medium をお試しください。</p>
                </div>
            </section>

            <!-- 基本的な使い方 -->
            <section class="content-section" id="basic-usage">
                <h2>2. 基本的な使い方</h2>

                <h3>マイク入力で音声認識</h3>
                <ol>
                    <li>RocketWhisperを起動</li>
                    <li>録音ボタン（マイクアイコン）をクリック</li>
                    <li>マイクに向かって話す</li>
                    <li>停止ボタンをクリック</li>
                    <li>認識結果がテキストエリアに表示される</li>
                </ol>

                <h3>ファイルから音声認識</h3>
                <ol>
                    <li>ファイル選択ボタンをクリック</li>
                    <li>音声ファイル（WAV/MP3/FLAC/OGG/M4A/WMA）を選択</li>
                    <li>自動的に認識処理が開始</li>
                    <li>認識結果がテキストエリアに表示される</li>
                </ol>

                <div class="info-card">
                    <h4>ドラッグ＆ドロップ対応</h4>
                    <p>音声ファイルをRocketWhisperのウィンドウにドラッグ＆ドロップするだけで、すぐに認識を開始できます。</p>
                </div>

                <h3>認識結果の利用</h3>
                <ul>
                    <li><strong>コピー</strong>: コピーボタンでクリップボードにコピー</li>
                    <li><strong>保存</strong>: 保存ボタンでテキストファイルとして保存</li>
                    <li><strong>自動コピー</strong>: 設定で有効にすると認識完了時に自動コピー</li>
                    <li><strong>自動貼り付け</strong>: 設定で有効にすると認識完了時に自動貼り付け</li>
                </ul>
            </section>

            <!-- 設定 -->
            <section class="content-section" id="settings">
                <h2>3. 設定</h2>
                <p>歯車アイコンをクリックして設定画面を開きます。8つのタブで詳細な設定が可能です。</p>

                <h3>モデル・言語タブ</h3>
                <ul>
                    <li><strong>モデル選択</strong>: 使用するWhisperモデルを選択</li>
                    <li><strong>言語</strong>: 認識言語（日本語/英語/中国語/韓国語/自動検出）</li>
                    <li><strong>句読点プロンプト</strong>: Whisperに句読点を含む認識結果を出力させる（推奨）</li>
                </ul>

                <h3>入力デバイスタブ</h3>
                <ul>
                    <li><strong>マイクデバイス</strong>: 使用するマイクを選択</li>
                    <li><strong>自動コピー</strong>: 認識完了時に自動でクリップボードにコピー</li>
                    <li><strong>自動貼り付け</strong>: 認識完了時に自動でアクティブウィンドウに貼り付け</li>
                </ul>

                <h3>ホットキータブ</h3>
                <ul>
                    <li><strong>グローバルホットキー</strong>: どのアプリからでも録音を開始できるショートカット</li>
                    <li><strong>有効/無効</strong>: ホットキー機能のオン/オフ</li>
                </ul>

                <h3>専門用語タブ</h3>
                <ul>
                    <li><strong>カスタム用語登録</strong>: 認識精度を向上させるための用語を登録</li>
                    <li><strong>トークン使用量</strong>: Whisperは最大224トークン相当の用語を受け付けます（日本語約100語）</li>
                </ul>

                <h3>テキスト処理タブ</h3>
                <ul>
                    <li><strong>句読点自動挿入</strong>: 認識後に後処理で句読点を追加</li>
                    <li><strong>改行自動挿入</strong>: 長い文章を自動的に改行</li>
                    <li><strong>音声コマンド</strong>: 音声コマンド機能の有効/無効</li>
                </ul>

                <h3>誤認識修正タブ</h3>
                <ul>
                    <li><strong>自動修正</strong>: 誤認識パターンを自動修正する機能の有効/無効</li>
                    <li><strong>プリセットルール</strong>: AI・技術用語、数字・日付、一般的な誤り、フィラー削除をワンクリックで追加</li>
                    <li><strong>カスタムルール</strong>: 独自の修正ルールを追加・編集（正規表現対応）</li>
                </ul>

                <h3>アプリ別処理タブ</h3>
                <ul>
                    <li><strong>処理モード</strong>: アプリごとに異なるテキスト処理設定を適用</li>
                    <li><strong>アプリマッピング</strong>: 特定のアプリに処理モードを割り当て</li>
                </ul>

                <h3>AI処理タブ</h3>
                <ul>
                    <li><strong>AIプロバイダ</strong>: OpenAI、Anthropic、Groq、Gemini、ローカルLLMから選択</li>
                    <li><strong>モデル選択</strong>: 使用するAIモデルを選択</li>
                    <li><strong>APIキー</strong>: 各プロバイダのAPIキーを入力</li>
                    <li><strong>接続テスト</strong>: 設定が正しいか確認</li>
                </ul>

                <div class="info-card">
                    <h4>句読点プロンプトと句読点自動挿入の違い</h4>
                    <table class="command-table">
                        <thead>
                            <tr>
                                <th>機能</th>
                                <th>処理タイミング</th>
                                <th>仕組み</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>句読点プロンプト</td>
                                <td>認識中（Whisper内部）</td>
                                <td>AIが文脈を理解して自然な位置に句読点を出力</td>
                            </tr>
                            <tr>
                                <td>句読点自動挿入</td>
                                <td>認識後（後処理）</td>
                                <td>「です」「ます」等の後に機械的に句点を挿入</td>
                            </tr>
                        </tbody>
                    </table>
                    <p>まずは<strong>句読点プロンプトのみ</strong>で試し、足りなければ句読点自動挿入も有効にすることをおすすめします。</p>
                </div>

                <h3>ライセンスタブ</h3>
                <ul>
                    <li><strong>ライセンス種別</strong>: 無料版、個人ライセンス、ビジネスライセンス</li>
                    <li><strong>ライセンスキー</strong>: ライセンスキーの入力と認証</li>
                </ul>
            </section>

            <!-- グローバルホットキー -->
            <section class="content-section" id="hotkey">
                <h2>4. グローバルホットキー</h2>
                <p>どのアプリケーションを使用中でも、設定したキーの組み合わせで即座に録音を開始できます。</p>

                <h3>設定方法</h3>
                <ol>
                    <li>設定画面を開く</li>
                    <li>「ホットキー」タブを選択</li>
                    <li>入力欄をクリック</li>
                    <li>使用したいキーの組み合わせを押す（例: <code>Ctrl + Shift + R</code>）</li>
                    <li>「有効」にチェックを入れる</li>
                </ol>

                <h3>使い方</h3>
                <ol>
                    <li>テキストエディタやブラウザなど、任意のアプリを開く</li>
                    <li>設定したホットキーを押す → 録音開始</li>
                    <li>話し終えたら再度ホットキーを押す → 録音停止</li>
                    <li>自動貼り付けが有効なら、認識結果が自動的に入力される</li>
                </ol>

                <div class="info-card">
                    <h4>おすすめのホットキー</h4>
                    <ul>
                        <li><code>Ctrl + Shift + R</code> - Record（録音）のR</li>
                        <li><code>Ctrl + Alt + V</code> - Voice（音声）のV</li>
                        <li><code>F9</code> - ファンクションキー（他と競合しにくい）</li>
                    </ul>
                </div>

                <h3>録音キャンセル</h3>
                <p>録音中に<kbd>Escape</kbd>キーを押すと、認識処理を行わずに録音をキャンセルできます。</p>
                <ul>
                    <li><strong>デフォルトキー</strong>: Escape</li>
                    <li><strong>カスタマイズ</strong>: 設定画面 → ホットキータブ → キャンセルホットキー</li>
                    <li><strong>有効/無効</strong>: チェックボックスで切り替え可能</li>
                </ul>
            </section>

            <!-- バッチ処理 -->
            <section class="content-section" id="batch">
                <h2>5. バッチ処理</h2>
                <p>複数の音声ファイルを一括で文字起こしできます。</p>

                <h3>バッチ処理の手順</h3>
                <ol>
                    <li>メニューから「バッチ処理」を選択</li>
                    <li>処理したいファイルを追加（複数選択可）</li>
                    <li>出力形式を選択（テキスト/SRT/VTT）</li>
                    <li>「処理開始」をクリック</li>
                    <li>処理完了まで待機</li>
                </ol>

                <h3>対応フォーマット</h3>
                <ul>
                    <li><strong>入力</strong>: WAV, MP3, FLAC, OGG, M4A, WMA</li>
                    <li><strong>出力</strong>: TXT（プレーンテキスト）, SRT（字幕）, VTT（Web字幕）</li>
                </ul>
            </section>

            <!-- 認識履歴 -->
            <section class="content-section" id="history">
                <h2>6. 認識履歴</h2>
                <p>過去の認識結果は自動的に保存され、いつでも参照・再利用できます。</p>

                <h3>履歴の確認</h3>
                <ol>
                    <li>履歴ボタン（時計アイコン）をクリック</li>
                    <li>過去の認識結果一覧が表示される</li>
                    <li>項目をクリックして詳細を確認</li>
                </ol>

                <h3>履歴の操作</h3>
                <ul>
                    <li><strong>検索</strong>: キーワードで過去の認識結果を検索</li>
                    <li><strong>コピー</strong>: 選択した結果をクリップボードにコピー</li>
                    <li><strong>削除</strong>: 不要な履歴を削除</li>
                    <li><strong>エクスポート</strong>: 履歴をファイルとして出力</li>
                </ul>

                <div class="info-card">
                    <h4>履歴の保存場所</h4>
                    <p>履歴データは <code>%APPDATA%\RocketWhisper\history.json</code> に保存されます。</p>
                </div>
            </section>

            <!-- テキスト処理 -->
            <section class="content-section" id="text-processing">
                <h2>7. テキスト処理（句読点・改行）</h2>
                <p>認識結果に句読点や改行を自動的に挿入する機能です。2つの方法があります。</p>

                <h3>句読点プロンプト（推奨）</h3>
                <p>Whisper AIに句読点を含む認識結果を出力させる機能です。</p>
                <ul>
                    <li><strong>仕組み</strong>: サンプル文をWhisperに渡すことで、句読点を含む出力を促す</li>
                    <li><strong>メリット</strong>: AIが文脈を理解して自然な位置に句読点を付ける</li>
                    <li><strong>対応言語</strong>: 日本語、英語、中国語、韓国語</li>
                </ul>

                <h3>句読点自動挿入（後処理）</h3>
                <p>認識後にルールベースで句読点を追加する機能です。</p>
                <ul>
                    <li><strong>仕組み</strong>: 「です」「ます」などの文末パターンを検出して句点を挿入</li>
                    <li><strong>メリット</strong>: Whisperが句読点を出力しなかった場合の補完に使える</li>
                    <li><strong>注意点</strong>: パターンマッチのため、文脈に依存しない機械的な処理</li>
                </ul>

                <h3>改行自動挿入</h3>
                <p>長い文章を適切な位置で改行します。</p>
                <ul>
                    <li>接続詞（「しかし」「また」など）の前で改行</li>
                    <li>100文字以上の長い文を句点で分割</li>
                </ul>

                <div class="info-card">
                    <h4>おすすめの設定</h4>
                    <ol>
                        <li>まず<strong>句読点プロンプトのみ</strong>を有効にして試す</li>
                        <li>句読点が足りない場合は<strong>句読点自動挿入</strong>も有効にする</li>
                        <li>長文の場合は<strong>改行自動挿入</strong>も検討</li>
                    </ol>
                </div>
            </section>

            <!-- 音声コマンド -->
            <section class="content-section" id="voice-commands">
                <h2>8. 音声コマンド</h2>
                <p>音声で改行や削除などの操作ができます。</p>

                <h3>利用可能なコマンド</h3>
                <table class="command-table">
                    <thead>
                        <tr>
                            <th>コマンド</th>
                            <th>トリガーフレーズ</th>
                            <th>動作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>改行</td>
                            <td>「改行」「かいぎょう」「エンター」</td>
                            <td>改行を挿入</td>
                        </tr>
                        <tr>
                            <td>段落</td>
                            <td>「段落」「だんらく」「新しい段落」</td>
                            <td>2回改行（段落区切り）</td>
                        </tr>
                        <tr>
                            <td>削除</td>
                            <td>「削除」「取り消し」「デリート」</td>
                            <td>直前の単語を削除</td>
                        </tr>
                    </tbody>
                </table>

                <div class="tip-box">
                    <p><strong>💡 句読点について</strong></p>
                    <p>句読点（。、？！）は「句読点プロンプト」や「句読点自動挿入」機能で自動的に挿入されます。設定画面のテキスト処理タブで有効にしてください。</p>
                </div>

                <h3>使い方のコツ</h3>
                <ul>
                    <li>コマンドは文章の区切りではっきりと発声する</li>
                    <li>コマンド前後に少し間を置くと認識精度が向上</li>
                    <li>設定画面で音声コマンドの有効/無効を切り替え可能</li>
                </ul>
            </section>

            <!-- 専門用語登録 -->
            <section class="content-section" id="custom-terms">
                <h2>9. 専門用語登録</h2>
                <p>業界特有の用語や固有名詞を登録して、認識精度を向上させます。</p>

                <h3>登録方法</h3>
                <ol>
                    <li>設定画面を開く</li>
                    <li>「専門用語」タブを選択</li>
                    <li>用語を入力して「追加」をクリック</li>
                </ol>

                <h3>登録容量について</h3>
                <p>Whisperが受け付ける専門用語の登録容量には上限があります（最大224文字相当）。</p>
                <ul>
                    <li><strong>日本語</strong>: 約100語程度</li>
                    <li><strong>英語</strong>: 約50語程度</li>
                </ul>
                <p>登録容量は設定画面でリアルタイムに確認できます。上限を超えると古い用語が無視されるため、よく使う用語を優先的に登録してください。</p>

                <div class="info-card">
                    <h4>この機能は完全無料です</h4>
                    <p>専門用語登録はWhisperの初期プロンプト機能を使用しており、すべてローカルで処理されます。APIコストは一切かかりません。</p>
                </div>
            </section>

            <!-- 誤認識修正ルール -->
            <section class="content-section" id="correction-rules">
                <h2>10. 誤認識修正ルール</h2>
                <p>特定の誤認識パターンを自動的に修正するルールを設定できます。IMEの単語登録のように、認識された文字列を別の文字列に置換します。</p>

                <h3>ルールの追加方法</h3>
                <ol>
                    <li>設定画面を開く</li>
                    <li>「誤認識修正」タブを選択</li>
                    <li>「誤認識パターンを自動修正する」にチェックを入れる</li>
                    <li>「修正ルールを編集...」ボタンをクリック</li>
                    <li>「検索パターン」と「置換文字列」を入力</li>
                    <li>「ルールを追加」をクリック</li>
                </ol>

                <h3>基本的な使い方（シンプル置換）</h3>
                <p>正規表現を使わずに、単純な文字列置換ができます。</p>
                <table class="command-table">
                    <thead>
                        <tr>
                            <th>検索パターン</th>
                            <th>置換文字列</th>
                            <th>説明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>マイクロソフト</td>
                            <td>Microsoft</td>
                            <td>カタカナ認識を英語に修正</td>
                        </tr>
                        <tr>
                            <td>モジョソフト</td>
                            <td>Mojosoft</td>
                            <td>会社名を正しい表記に</td>
                        </tr>
                        <tr>
                            <td>ウィスパー</td>
                            <td>Whisper</td>
                            <td>製品名を正しい表記に</td>
                        </tr>
                    </tbody>
                </table>

                <h3>正規表現の使用（高度な置換）</h3>
                <p>「正規表現を使用」にチェックを入れると、高度なパターンマッチングが可能です。</p>
                <table class="command-table">
                    <thead>
                        <tr>
                            <th>検索パターン</th>
                            <th>置換文字列</th>
                            <th>説明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>マイクロ\s*ソフト</td>
                            <td>Microsoft</td>
                            <td>スペースの有無に関係なく置換</td>
                        </tr>
                        <tr>
                            <td>ですね$</td>
                            <td>ですね。</td>
                            <td>文末の「ですね」の後に句点を追加</td>
                        </tr>
                    </tbody>
                </table>

                <p class="table-note"><strong>正規表現の記号説明:</strong></p>
                <ul class="regex-notes">
                    <li><code>\s*</code> : 空白文字（スペース、タブなど）が0個以上あることを表します。「マイクロ\s*ソフト」は「マイクロソフト」「マイクロ ソフト」の両方にマッチします。</li>
                    <li><code>$</code> : 行の末尾を表します。「ですね$」は行末の「ですね」にのみマッチし、文中の「ですね」には反応しません。</li>
                </ul>

                <div class="info-card">
                    <h4>内蔵ハルシネーション対策</h4>
                    <p>RocketWhisperには73種類のWhisperハルシネーション対策が内蔵されています。「ご視聴ありがとうございました」などの不要なフレーズは自動的に削除されます。</p>
                </div>

                <div class="tip-box">
                    <p><strong>💡 専門用語登録との違い</strong></p>
                    <ul>
                        <li><strong>専門用語登録</strong>: Whisperに「この単語が出るかも」とヒントを与え、認識精度を向上させる</li>
                        <li><strong>誤認識修正ルール</strong>: 認識結果を後から別の文字列に置換する</li>
                    </ul>
                    <p>両方を組み合わせて使うと、より正確な認識結果が得られます。</p>
                </div>
            </section>

            <!-- アプリ別処理モード -->
            <section class="content-section" id="app-specific">
                <h2>11. アプリ別処理モード</h2>
                <p>使用するアプリケーションに応じて、異なるテキスト処理設定を自動的に適用できます。</p>

                <h3>処理モード一覧</h3>
                <p>処理モードは、句読点挿入・改行・音声コマンドなどの設定をまとめたプリセットです。</p>
                <table class="command-table">
                    <thead>
                        <tr>
                            <th>モード</th>
                            <th>アイコン</th>
                            <th>AI必須</th>
                            <th>説明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>スマート</td>
                            <td>✨</td>
                            <td>不要</td>
                            <td>句読点・改行を自動で整形（標準設定）</td>
                        </tr>
                        <tr>
                            <td>シンプル</td>
                            <td>📋</td>
                            <td>不要</td>
                            <td>認識したテキストをそのまま出力</td>
                        </tr>
                        <tr>
                            <td>ビジネス</td>
                            <td>💼</td>
                            <td>必須</td>
                            <td>敬語・丁寧な文体に自動変換</td>
                        </tr>
                        <tr>
                            <td>カジュアル</td>
                            <td>💬</td>
                            <td>必須</td>
                            <td>親しみやすい文体に変換</td>
                        </tr>
                        <tr>
                            <td>要約</td>
                            <td>📝</td>
                            <td>必須</td>
                            <td>テキストを簡潔に要約</td>
                        </tr>
                        <tr>
                            <td>翻訳（日→英）</td>
                            <td>🌐</td>
                            <td>必須</td>
                            <td>日本語を英語に翻訳</td>
                        </tr>
                        <tr>
                            <td>文法修正</td>
                            <td>✔️</td>
                            <td>必須</td>
                            <td>誤認識・文法を自動修正</td>
                        </tr>
                    </tbody>
                </table>
                <div class="tip-box">
                    <p><strong>💡 ヒント</strong></p>
                    <p>「AI必須」のモードを使用するには、設定画面の「AI処理」タブでAIプロバイダを設定してください。</p>
                </div>

                <h3>アプリへのモード割り当て</h3>
                <ol>
                    <li>設定画面を開く</li>
                    <li>「アプリ別処理」タブを選択</li>
                    <li>「アプリを追加」をクリック</li>
                    <li>対象アプリを選択（実行中のアプリ一覧から選択または手動入力）</li>
                    <li>適用する処理モードを選択</li>
                </ol>

                <h3>活用例</h3>
                <ul>
                    <li><strong>メールソフト</strong>: 句読点・改行を自動挿入（スマートモード）</li>
                    <li><strong>プログラミングエディタ</strong>: 整形なし（シンプルモード）</li>
                    <li><strong>メモ帳</strong>: 箇条書き向けの設定（カスタムモード）</li>
                </ul>

                <div class="info-card">
                    <h4>標準の処理モード</h4>
                    <p>アプリが未登録の場合は「標準」モードが適用されます。標準モードの設定は「テキスト処理」タブで変更できます。</p>
                </div>
            </section>

            <!-- AI処理（LLM連携） -->
            <section class="content-section" id="ai-formatting">
                <h2>12. AI処理（LLM連携）</h2>
                <p>外部のAI（LLM）と連携して、認識結果を自動的にビジネス敬語やカジュアル文体に変換したり、要約・翻訳を行う機能です。ローカルLLM（LM Studio/Ollama）を使えば、オフライン環境でもAI処理が利用できます。</p>

                <h3>対応AIプロバイダ</h3>
                <table class="command-table">
                    <thead>
                        <tr>
                            <th>プロバイダ</th>
                            <th>モデル例</th>
                            <th>特徴</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>OpenAI</td>
                            <td>gpt-4o, gpt-4o-mini</td>
                            <td>高精度、安定した品質</td>
                        </tr>
                        <tr>
                            <td>Anthropic</td>
                            <td>Claude 4.5 Sonnet/Haiku</td>
                            <td>自然な日本語、長文対応</td>
                        </tr>
                        <tr>
                            <td>Groq</td>
                            <td>LLaMA 3.3 70B, Mixtral</td>
                            <td>高速・無料枠あり</td>
                        </tr>
                        <tr>
                            <td>Google Gemini</td>
                            <td>gemini-2.5-pro/flash</td>
                            <td>無料枠豊富、高品質</td>
                        </tr>
                        <tr>
                            <td>ローカルLLM</td>
                            <td>LM Studio, Ollama</td>
                            <td>オフライン動作、プライバシー保護</td>
                        </tr>
                    </tbody>
                </table>

                <h3>設定方法</h3>
                <ol>
                    <li>設定画面を開く</li>
                    <li>「AI処理」タブを選択</li>
                    <li>使用するプロバイダを選択</li>
                    <li>APIキーを入力（ローカルLLMの場合はベースURLのみ）</li>
                    <li>「接続テスト」で動作確認</li>
                </ol>

                <h3>AI処理モード</h3>
                <p>AI処理を設定すると、アプリ別処理で以下のモードが使用可能になります。</p>
                <table class="command-table">
                    <thead>
                        <tr>
                            <th>モード</th>
                            <th>説明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>💼 ビジネス</td>
                            <td>敬語・丁寧な文体に自動変換</td>
                        </tr>
                        <tr>
                            <td>💬 カジュアル</td>
                            <td>親しみやすい文体に変換</td>
                        </tr>
                        <tr>
                            <td>📝 要約</td>
                            <td>テキストを簡潔に要約</td>
                        </tr>
                        <tr>
                            <td>🌐 翻訳</td>
                            <td>日本語から英語に翻訳</td>
                        </tr>
                        <tr>
                            <td>✔️ 文法修正</td>
                            <td>誤認識・文法を自動修正</td>
                        </tr>
                    </tbody>
                </table>

                <h3>ローカルLLM（LM Studio）の設定例</h3>
                <h4>LM Studio側の設定</h4>
                <ol>
                    <li>LM Studioを起動</li>
                    <li>使用するモデルを選択</li>
                    <li>ステータスバーの User / Power User / Developer から「Power User」もしくは「Developer」を選択</li>
                    <li>Developerタブに移動（左側メニューの緑色の「Developer」アイコンをクリック）</li>
                    <li>画面上の「Status: Running」のトグルがオンになっていればサーバーは起動しています</li>
                    <li>「Running」であれば、API URL（例: <code>http://localhost:1234</code>）が表示されます</li>
                    <li>サーバーを停止するには、トグルをクリックして「Stopped」にします</li>
                </ol>
                <h4>RocketWhisper側の設定</h4>
                <ol>
                    <li>RocketWhisperの設定画面 → AI処理タブ</li>
                    <li>「ローカルLLM」を選択</li>
                    <li>ベースURL: <code>http://127.0.0.1:1234</code> を入力</li>
                    <li>モデルID: 空欄のままでOK（サーバーでロード中のモデルを使用）</li>
                    <li>「接続テスト」をクリックして確認</li>
                </ol>

                <div class="info-card">
                    <h4>ローカルLLMのメリット</h4>
                    <ul>
                        <li><strong>完全オフライン</strong>: 音声認識もAI処理もインターネット接続不要</li>
                        <li><strong>プライバシー保護</strong>: 音声データもテキストも外部に一切送信されません</li>
                        <li><strong>無料</strong>: APIコストがかかりません</li>
                    </ul>
                    <p>※ /v1 パスは自動的に追加されます</p>
                </div>

                <div class="tip-box">
                    <p><strong>💡 処理フロー</strong></p>
                    <p>AI処理は、音声認識 → 句読点挿入 → 改行挿入 → <strong>AI処理</strong> → 半角→全角変換 の順で処理されます。AI処理が失敗した場合は、元のテキストがそのまま使用されます。</p>
                </div>
            </section>

            <!-- AIコマンドモード -->
            <section class="content-section" id="ai-command">
                <h2>13. AIコマンドモード</h2>
                <p>テキストを選択して専用ホットキーを押し、音声で指示するだけでAIが即座にテキストを処理する機能です。翻訳、要約、敬語変換など、自由な指示に対応します。</p>

                <h3>基本的な使い方</h3>
                <ol>
                    <li>任意のアプリケーション（メモ帳、ブラウザ、Word等）でテキストを選択</li>
                    <li>AIコマンドホットキー（デフォルト: <code>Ctrl + Shift + A</code>）を押す</li>
                    <li>ステータスが「音声指示を待機中...」に変わるので、音声で指示（例: 「日本語に翻訳して」「要約して」「敬語に直して」）</li>
                    <li>もう一度AIコマンドホットキーを押して録音停止</li>
                    <li>AIが処理を実行し、結果がRocketWhisperのテキストエリアに表示されます</li>
                </ol>

                <h3>使用例</h3>
                <table class="command-table">
                    <thead>
                        <tr>
                            <th>選択テキスト</th>
                            <th>音声指示</th>
                            <th>結果</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>英語の文章</td>
                            <td>「日本語に翻訳して」</td>
                            <td>日本語に翻訳されたテキスト</td>
                        </tr>
                        <tr>
                            <td>長い議事録</td>
                            <td>「要約して」</td>
                            <td>簡潔な要約</td>
                        </tr>
                        <tr>
                            <td>カジュアルなメモ</td>
                            <td>「敬語に直して」</td>
                            <td>ビジネス文体のテキスト</td>
                        </tr>
                        <tr>
                            <td>プログラムのコード</td>
                            <td>「コメントを追加して」</td>
                            <td>コメント付きのコード</td>
                        </tr>
                    </tbody>
                </table>

                <h3>ホットキーの設定</h3>
                <ol>
                    <li>設定画面を開く</li>
                    <li>「ホットキー」タブを選択</li>
                    <li>「AIコマンドホットキー」の入力欄をクリック</li>
                    <li>使用したいキーの組み合わせを押す（デフォルト: <code>Ctrl + Shift + A</code>）</li>
                    <li>「有効」にチェックを入れる</li>
                </ol>

                <div class="info-card">
                    <h4>前提条件</h4>
                    <p>AIコマンドモードを使用するには、設定画面の「AI処理」タブでAIプロバイダを設定する必要があります。ローカルLLM（LM Studio / Ollama）を使えば、完全オフライン・完全無料で利用できます。</p>
                </div>

                <div class="tip-box">
                    <p><strong>💡 排他制御</strong></p>
                    <p>通常の録音中はAIコマンドは無効になり、AIコマンド録音中は通常のホットキーは無効になります。誤操作を防ぐ安全設計です。</p>
                </div>
            </section>

            <!-- 録音中インジケーター -->
            <section class="content-section" id="recording-indicator">
                <h2>14. 録音中インジケーター</h2>
                <p>タスクトレイに格納した状態でホットキー録音を行うと、録音状態を視覚的に確認できるフローティングウィンドウが表示されます。</p>

                <h3>インジケーターの機能</h3>
                <ul>
                    <li><strong>リアルタイム波形表示</strong>: 16本のバーで音声レベルを視覚化</li>
                    <li><strong>処理モード表示</strong>: 現在適用中のモード（スマート、ビジネス等）をアイコンと名前で表示</li>
                    <li><strong>フォーカス非奪取</strong>: 他のアプリの操作を妨げません</li>
                    <li><strong>ドラッグ移動</strong>: 好きな位置に移動可能、位置は自動保存</li>
                </ul>

                <h3>デフォルト位置</h3>
                <p>初回は画面下部中央（タスクバーの上）に表示されます。ドラッグして移動すると、次回から同じ位置に表示されます。</p>

                <div class="info-card">
                    <h4>インジケーターの表示条件</h4>
                    <p>録音中インジケーターは、RocketWhisperがタスクトレイに格納されている状態でホットキー録音を行ったときのみ表示されます。メインウィンドウが表示されている場合は表示されません。</p>
                </div>
            </section>

            <!-- 音声ランチャー -->
            <section class="content-section" id="voice-launcher">
                <h2>15. 音声ランチャー</h2>
                <p>特定のキーワードを認識したら、対応するアプリケーションを自動起動する機能です。「メモ帳」と話すだけでメモ帳が開くなど、声だけでアプリを操作できます。</p>

                <h3>設定方法</h3>
                <ol>
                    <li>設定画面を開き、「音声ランチャー」タブを選択</li>
                    <li>「音声ランチャーを有効にする」にチェック</li>
                    <li>「ランチャー設定を編集...」をクリック</li>
                    <li>「追加」ボタンでキーワードと実行ファイルを登録</li>
                    <li>設定画面で「保存」をクリック</li>
                </ol>

                <h3>登録項目</h3>
                <table class="command-table">
                    <thead>
                        <tr>
                            <th>項目</th>
                            <th>説明</th>
                            <th>例</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>キーワード</td>
                            <td>起動トリガーとなる言葉</td>
                            <td>メモ帳、電卓、ブラウザ</td>
                        </tr>
                        <tr>
                            <td>実行ファイル</td>
                            <td>起動するアプリのパス</td>
                            <td>C:\Windows\notepad.exe</td>
                        </tr>
                        <tr>
                            <td>パラメータ</td>
                            <td>起動時の引数（オプション）</td>
                            <td>--new-window</td>
                        </tr>
                        <tr>
                            <td>説明</td>
                            <td>メモ（オプション）</td>
                            <td>メモ帳を起動</td>
                        </tr>
                    </tbody>
                </table>

                <h3>マッチング仕様</h3>
                <ul>
                    <li><strong>完全一致</strong>: 認識結果がキーワードと完全に一致した場合のみ起動</li>
                    <li><strong>句読点は無視</strong>: 末尾の「、」「。」「！」「？」は自動的に除去されます</li>
                    <li><strong>大文字小文字を区別しない</strong>: 英単語は大文字小文字を区別しません</li>
                </ul>

                <div class="tip-box">
                    <h4>登録のコツ</h4>
                    <p>話す言葉をそのままキーワードとして登録してください。例えば「メモ帳を開いて」と話すなら、キーワードも「メモ帳を開いて」と登録します。短いキーワード（「メモ帳」など）の方が認識しやすくなります。</p>
                </div>

                <div class="info-card">
                    <h4>音声コマンドとの違い</h4>
                    <p>音声コマンド（「改行」「段落」など）はテキスト編集用の機能で、音声ランチャーはアプリケーション起動用の機能です。両方を同時に有効にできますが、同じキーワードが登録されている場合は音声ランチャーが優先されます。</p>
                </div>
            </section>

            <!-- 音声検索 -->
            <section class="content-section" id="voice-search">
                <h2>16. 音声検索</h2>
                <p>通常の音声入力で「〇〇について調べて」と話すだけで、デフォルトブラウザでGoogle検索を自動実行する機能です。</p>

                <h3>対応フレーズ</h3>
                <table class="command-table">
                    <thead>
                        <tr>
                            <th>フレーズ</th>
                            <th>例</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>〇〇について調べて</td>
                            <td>「東京タワーについて調べて」</td>
                        </tr>
                        <tr>
                            <td>〇〇を検索して</td>
                            <td>「天気予報を検索して」</td>
                        </tr>
                        <tr>
                            <td>〇〇をググって</td>
                            <td>「レシピをググって」</td>
                        </tr>
                        <tr>
                            <td>〇〇について教えて</td>
                            <td>「Pythonについて教えて」</td>
                        </tr>
                        <tr>
                            <td>〇〇って何？</td>
                            <td>「AIって何？」</td>
                        </tr>
                        <tr>
                            <td>〇〇とは</td>
                            <td>「機械学習とは」</td>
                        </tr>
                        <tr>
                            <td>Search 〇〇 / Look up 〇〇</td>
                            <td>「Search RocketWhisper」</td>
                        </tr>
                        <tr>
                            <td>Google 〇〇</td>
                            <td>「Google weather forecast」</td>
                        </tr>
                    </tbody>
                </table>

                <h3>設定方法</h3>
                <ol>
                    <li>設定画面を開く</li>
                    <li>「音声ランチャー」タブを選択</li>
                    <li>「音声検索を有効にする」にチェック</li>
                </ol>

                <div class="info-card">
                    <h4>動作の仕組み</h4>
                    <p>録音 → 音声認識 → フレーズ検出 → デフォルトブラウザでGoogle検索を自動起動という流れで動作します。検索フレーズに一致しない場合は、通常のテキスト処理パイプラインに進みます。</p>
                </div>

                <div class="tip-box">
                    <p><strong>💡 音声ランチャーとの違い</strong></p>
                    <p>音声ランチャーは「登録したキーワードに完全一致でアプリ起動」、音声検索は「検索フレーズのパターンに一致でブラウザ検索」です。両方を同時に有効にできます。</p>
                </div>
            </section>

            <!-- トレイアイコン -->
            <section class="content-section" id="tray-icon">
                <h2>17. トレイアイコン</h2>
                <p>タスクトレイのアイコンでアプリケーションの状態を確認できます。</p>

                <h3>アイコンの状態</h3>
                <table class="command-table">
                    <thead>
                        <tr>
                            <th>状態</th>
                            <th>アイコン</th>
                            <th>説明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>待機中</td>
                            <td>🎤（青）</td>
                            <td>録音待機状態</td>
                        </tr>
                        <tr>
                            <td>録音中</td>
                            <td>🎤（青）+ 🔴（点滅）</td>
                            <td>右下に赤い丸が点滅</td>
                        </tr>
                        <tr>
                            <td>処理中</td>
                            <td>⚙️（黄・回転）</td>
                            <td>Whisperで音声認識中</td>
                        </tr>
                    </tbody>
                </table>

                <h3>トレイアイコンの操作</h3>
                <ul>
                    <li><strong>左クリック</strong>: メインウィンドウを表示</li>
                    <li><strong>右クリック</strong>: コンテキストメニューを表示</li>
                </ul>
            </section>

            <!-- トラブルシューティング -->
            <section class="content-section" id="troubleshooting">
                <h2>18. トラブルシューティング</h2>

                <div class="faq-item">
                    <button class="faq-question">モデルのダウンロードが途中で止まる</button>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            <p>ネットワーク接続を確認してください。ファイアウォールやプロキシの設定が原因の場合があります。</p>
                            <ul>
                                <li>インターネット接続を確認</li>
                                <li>ファイアウォールでRocketWhisperを許可</li>
                                <li>VPNを一時的に無効化</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="faq-item">
                    <button class="faq-question">認識精度が低い</button>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            <ul>
                                <li>large-v3-turboモデルを使用（高精度・高速、デフォルト）</li>
                                <li>マイクを口に近づける</li>
                                <li>周囲の騒音を減らす</li>
                                <li>専門用語を登録する（※専門用語の認識精度をさらに向上させたい場合は、large-v3モデルの使用もご検討ください）</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="faq-item">
                    <button class="faq-question">ホットキーが動作しない</button>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            <ul>
                                <li>設定でホットキーが「有効」になっているか確認</li>
                                <li>他のアプリと競合していないか確認</li>
                                <li>管理者権限で実行してみる</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="faq-item">
                    <button class="faq-question">音声コマンドが認識されない</button>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            <ul>
                                <li>設定で音声コマンドが「有効」になっているか確認</li>
                                <li>コマンドをはっきりと発声する</li>
                                <li>コマンドの前後に少し間を置く</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="faq-item">
                    <button class="faq-question">アプリが起動しない</button>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            <ul>
                                <li>.NET 8.0 Desktop Runtimeがインストールされているか確認</li>
                                <li>Windows 11 64bitであるか確認</li>
                                <li>アンチウイルスソフトにブロックされていないか確認</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- サポートへのリンク -->
            <section class="content-section">
                <div class="info-card">
                    <h4>問題が解決しない場合</h4>
                    <p><a href="support.html">サポートページ</a>からお問い合わせください。</p>
                </div>
            </section>
        </div>
    </main>

    <!-- フッター -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <img src="images/RocketWhisper3.png" alt="RocketWhisper" class="footer-logo">
                    <span class="footer-name">RocketWhisper</span>
                    <p class="footer-tagline">声を、テキストに。瞬時に、正確に。</p>
                </div>
                <div class="footer-links">
                    <div class="footer-column">
                        <h4>製品</h4>
                        <ul>
                            <li><a href="index.html#features">機能</a></li>
                            <li><a href="index.html#download">ダウンロード</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4>サポート</h4>
                        <ul>
                            <li><a href="help.html">ヘルプ</a></li>
                            <li><a href="support.html">お問い合わせ</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4>法的情報</h4>
                        <ul>
                            <li><a href="privacy.html">プライバシーポリシー</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 Mojosoft Co., Ltd. All rights reserved.</p>
                <p class="footer-credits">Powered by OpenAI Whisper</p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
</body>
</html>
